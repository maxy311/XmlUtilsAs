!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(module,exports,__webpack_require__){"use strict";var _utils=__webpack_require__(1),_client=__webpack_require__(2),client=_interopRequireWildcard(_client),_video=__webpack_require__(4);function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}__webpack_require__(5);var intersectionObserver=new IntersectionObserver(function(e){if(e.length>0&&0!==e.length){var t=!0,i=!1,n=void 0;try{for(var o,r=e[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var s=o.value;if(s.isIntersecting){console.log(s);var l=s.target;window.now_article=l,client.showDownloadBtn("simple")}}}catch(e){i=!0,n=e}finally{try{!t&&r.return&&r.return()}finally{if(i)throw n}}}},{threshold:.7});function addListener(){document.getElementsByClassName("smart-bar").length>0&&document.getElementsByClassName("smart-bar")[0].remove(),document.getElementsByClassName("container").length>0&&document.getElementsByClassName("top-banner").length>0&&(document.getElementsByClassName("container")[0].style["padding-top"]=0,document.getElementsByClassName("top-banner")[0].remove());var e=[],t=document.getElementsByClassName("_video_feed_trending_mobile_item");if(t.length>0)for(var i=0;i<t.length;++i)e.push(t[i]);if(!(e.length<=0)){var n=!0,o=!1,r=void 0;try{for(var s,l=e[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){!function(e){var t=e.getAttribute("class");-1==t.indexOf("dl_tag")&&(e.setAttribute("class",t+" dl_tag"),intersectionObserver.observe(e))}(s.value)}}catch(e){o=!0,r=e}finally{try{!n&&l.return&&l.return()}finally{if(o)throw r}}}}function btnClick(e){var t,i,n,o=e.getElementsByClassName("_video_card_");if(0!==o.length){i=(o=o[0]).getAttribute("src"),n=o.getAttribute("poster")||"";var r=e.getElementsByClassName("_simulation_app_meta_info_title");t=(r=r.length>0?r[0]:e.getElementsByClassName("_simulation_app_uniqueId")[0]).innerText;var s=new _video.dl_video;s.title=t,s.source="tiktok",s.thumbnail=n;var l=new _video.dl_video_file;l.url=i,l.resolution="MP4",l.format="MP4",s.videos.push(l),console.log(JSON.stringify(s)),client.showVideoInfo(s)}else client.setVideoInfoError()}function getVideoId(e){if(!e)return null;var t="";return-1===e.indexOf("/share/video/")&&-1===e.indexOf("/v/")||((t=(0,_utils.between)(e,"/share/video/","?"))||(t=(0,_utils.between)(e,"/v/","?")),!t)?null:t}function getInfo(url){console.log("getInfo start");var headers={Referer:url,"User-Agent":"Mozilla/5.0 (Linux; Android 5.0; SM-G900P Build/LRX21T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Mobile Safari/537.36"},params={url:url,method:"get",header:JSON.stringify(headers)},res=JSON.parse(client.http(params)).result;console.log("get res success");var videoData=(0,_utils.between)(res,'"videoData":',',"shareUser"');if(videoData){videoData=eval("("+videoData+")");var itemInfos=videoData.itemInfos,dlVideo=new _video.dl_video;dlVideo.id=itemInfos.id,dlVideo.title=itemInfos.text||"Tiktok",dlVideo.source="tiktok",dlVideo.thumbnail=itemInfos.covers[0]||"";var dlVideoFile=new _video.dl_video_file;if(dlVideoFile.id=itemInfos.id,dlVideoFile.url=itemInfos.video.urls[0],dlVideoFile.resolution="720P",dlVideoFile.format="MP4",dlVideo.videos.push(dlVideoFile),console.log("get video info success"),videoData.musicInfos&&videoData.musicInfos.musicId){var musicId=videoData.musicInfos.musicId;console.log("get music start");var musicUrl="https://www.tiktok.com/share/music/"+musicId,params2={url:musicUrl,method:"get",header:JSON.stringify({Referer:musicUrl,"User-Agent":"Mozilla/5.0 (Linux; Android 4.4.2; Nexus 4 Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.114 Mobile Safari/537.36"})},musicRes=JSON.parse(client.http(params2)).result;if(musicRes){console.log("get music http res success");var musicData=(0,_utils.between)(musicRes,'"musicData":',',"shareUser"');if(musicData){musicData=eval("("+musicData+")");var dlVideoFile2=new _video.dl_video_file;dlVideoFile2.id=musicData.musicId,dlVideoFile2.url=musicData.playUrl[0],dlVideoFile2.resolution="MP3",dlVideoFile2.format="MP3",dlVideo.audios.push(dlVideoFile2)}}else console.log("get music http res nul")}return dlVideo}return!1}function btnStateInit(){console.log("in btnStateInit");var e=document,t=new MutationObserver(function(e){console.log("in callback",document.getElementsByClassName("_video_feed_trending_mobile_item").length),(document.getElementsByClassName("_video_feed_trending_mobile_item").length>0||document.getElementsByClassName("top-banner").length>0)&&(addListener(),t.disconnect())});t.observe(e,{childList:!0,subtree:!0})}window.videoCheck=function(e){console.log("videoCheck url",e),null===getVideoId(e)||client.showDownloadBtn("analyze")},window.getVideoInfo=function(e){var t=window.now_article;if(t)btnClick(t);else if(getVideoId(e)){var i=getInfo(e);i?(console.log(JSON.stringify(i)),client.setVideoInfo(i)):client.setVideoInfoError()}else console.log("now_article is null or getVideoId is null"),client.setVideoInfoError("now_article is null or getVideoId is null")},window.onscroll=function(){addListener()},window.now_article="",client.showDownloadBtn("disable"),console.log("load js"),btnStateInit()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.al=function(){alert("start")},t.replace_handle=function(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/&quot;/g,'"')).replace(/&#123;/g,"}")).replace(/&amp;/g,"&")).replace(/u003C/g,"<")).replace(/\\3a/i,":")).replace(/\\26/g,"&")).replace(/\\3d/g,"=")).replace(/\\25/g,"%")).replace(/\\/g,"")).replace(/&#039;/g,"'")).replace(/ /g,"")},t.isElementInViewport=function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.top<(window.innerHeight||document.documentElement.clientHeight)};var n=t.indexOf=function(e,t){return t instanceof RegExp?e.search(t):e.indexOf(t)};t.between=function(e,t,i){var o=n(e,t);return-1===o?"":(e=e.slice(o+t.length),-1===(o=n(e,i))?"":e=e.slice(0,o))}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.http=function(e){var t={url:"",isEncode:!1,postData:"",method:"",header:""};return t=n(t,e),window.shareitBridge.syncInvoke("download","httpRequest",JSON.stringify(t))},t.getAppVersion=function(){var e=window.shareitBridge.syncInvoke("download","getDeviceInfo","");return(e=JSON.parse(e)).app_ver||""},t.setVideoInfo=function(e){window.videoBrowser.setVideoInfo(JSON.stringify(e))},t.showVideoInfo=function(e){window.videoBrowser.showVideoInfo(JSON.stringify(e))},t.showDownloadBtn=function(e){window.videoBrowser.showDownloadBtn(e)},t.setVideoInfoError=function(e){window.videoBrowser.setVideoInfoError()},t.httpGetCookie=function(e){return window.videoBrowser.httpGetCookie(e)};var n=i(3)},function(e,t,i){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var i,s,l=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),a=1;a<arguments.length;a++){for(var c in i=Object(arguments[a]))o.call(i,c)&&(l[c]=i[c]);if(n){s=n(i);for(var u=0;u<s.length;u++)r.call(i,s[u])&&(l[s[u]]=i[s[u]])}}return l}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dl_video=function(){this.id="",this.title="",this.description="",this.thumbnail="",this.source="",this.audios=[],this.videos=[],this.images=[]},t.dl_video_file=function(){this.id="",this.resolution="",this.bitrate="",this.width=0,this.height=0,this.format="",this.size="",this.url=""}},function(e,t){!function(){"use strict";if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var e=window.document,t=[];n.prototype.THROTTLE_TIMEOUT=100,n.prototype.POLL_INTERVAL=null,n.prototype.USE_MUTATION_OBSERVER=!0,n.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},n.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e}),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},n.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},n.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},n.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter(function(e,t,i){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==i[t-1]})},n.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map(function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}});return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},n.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(o(window,"resize",this._checkForIntersections,!0),o(e,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in window&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},n.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,r(window,"resize",this._checkForIntersections,!0),r(e,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},n.prototype._checkForIntersections=function(){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach(function(n){var o=n.element,r=s(o),l=this._rootContainsTarget(o),a=n.entry,c=e&&l&&this._computeTargetAndRootIntersection(o,t),u=n.entry=new i({time:window.performance&&performance.now&&performance.now(),target:o,boundingClientRect:r,rootBounds:t,intersectionRect:c});a?e&&l?this._hasCrossedThreshold(a,u)&&this._queuedEntries.push(u):a&&a.isIntersecting&&this._queuedEntries.push(u):this._queuedEntries.push(u)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},n.prototype._computeTargetAndRootIntersection=function(t,i){if("none"!=window.getComputedStyle(t).display){for(var n,o,r,l,c,u,d,h,f=s(t),p=a(t),g=!1;!g;){var m=null,v=1==p.nodeType?window.getComputedStyle(p):{};if("none"==v.display)return;if(p==this.root||p==e?(g=!0,m=i):p!=e.body&&p!=e.documentElement&&"visible"!=v.overflow&&(m=s(p)),m&&(n=m,o=f,r=void 0,l=void 0,c=void 0,u=void 0,d=void 0,h=void 0,r=Math.max(n.top,o.top),l=Math.min(n.bottom,o.bottom),c=Math.max(n.left,o.left),u=Math.min(n.right,o.right),h=l-r,!(f=(d=u-c)>=0&&h>=0&&{top:r,bottom:l,left:c,right:u,width:d,height:h})))break;p=a(p)}return f}},n.prototype._getRootRect=function(){var t;if(this.root)t=s(this.root);else{var i=e.documentElement,n=e.body;t={top:0,left:0,right:i.clientWidth||n.clientWidth,width:i.clientWidth||n.clientWidth,bottom:i.clientHeight||n.clientHeight,height:i.clientHeight||n.clientHeight}}return this._expandRectByRootMargin(t)},n.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map(function(t,i){return"px"==t.unit?t.value:t.value*(i%2?e.width:e.height)/100}),i={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return i.width=i.right-i.left,i.height=i.bottom-i.top,i},n.prototype._hasCrossedThreshold=function(e,t){var i=e&&e.isIntersecting?e.intersectionRatio||0:-1,n=t.isIntersecting?t.intersectionRatio||0:-1;if(i!==n)for(var o=0;o<this.thresholds.length;o++){var r=this.thresholds[o];if(r==i||r==n||r<i!=r<n)return!0}},n.prototype._rootIsInDom=function(){return!this.root||l(e,this.root)},n.prototype._rootContainsTarget=function(t){return l(this.root||e,t)},n.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},n.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)},window.IntersectionObserver=n,window.IntersectionObserverEntry=i}function i(e){this.time=e.time,this.target=e.target,this.rootBounds=e.rootBounds,this.boundingClientRect=e.boundingClientRect,this.intersectionRect=e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0},this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,i=t.width*t.height,n=this.intersectionRect,o=n.width*n.height;this.intersectionRatio=i?Number((o/i).toFixed(4)):this.isIntersecting?1:0}function n(e,t){var i,n,o,r=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(r.root&&1!=r.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(i=this._checkForIntersections.bind(this),n=this.THROTTLE_TIMEOUT,o=null,function(){o||(o=setTimeout(function(){i(),o=null},n))}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(r.rootMargin),this.thresholds=this._initThresholds(r.threshold),this.root=r.root||null,this.rootMargin=this._rootMarginValues.map(function(e){return e.value+e.unit}).join(" ")}function o(e,t,i,n){"function"==typeof e.addEventListener?e.addEventListener(t,i,n||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,i)}function r(e,t,i,n){"function"==typeof e.removeEventListener?e.removeEventListener(t,i,n||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,i)}function s(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function l(e,t){for(var i=t;i;){if(i==e)return!0;i=a(i)}return!1}function a(e){var t=e.parentNode;return t&&11==t.nodeType&&t.host?t.host:t&&t.assignedSlot?t.assignedSlot.parentNode:t}}()}]);